import{a as D}from"./chunk-BFPH4HRU.js";import{d as C}from"./chunk-I744FCMO.js";import{a as K}from"./chunk-HOEQLIYF.js";import{a as J}from"./chunk-KTM2XAWU.js";import{a as H}from"./chunk-YW63CB76.js";import{a as R,f as j,h as M}from"./chunk-PC5BKWSZ.js";import{a as ie}from"./chunk-TVFP3UJM.js";import{c as Q,d as W,h as X,i as Y,j as Z,k as ee,l as te}from"./chunk-VWDGVE3M.js";import"./chunk-QUCLZ2T2.js";import{a as ne}from"./chunk-D2GFGNJ7.js";import{a as U}from"./chunk-ZLFFNHPO.js";import{h as L,i as O,k as q}from"./chunk-UZ4LNRWY.js";import{Aa as a,Ga as u,H as b,J as B,La as F,Ma as y,Na as S,Oa as E,P,Pa as I,Qa as t,Ra as n,Sa as p,Ua as $,V as c,X as T,Za as g,_a as d,aa as h,ba as x,cb as r,db as f,eb as s,jb as V,mb as _,n as G,nb as z,ob as k,pa as N}from"./chunk-7VSCR5LV.js";import{a as A}from"./chunk-2XJVAMHT.js";var re=(()=>{let m=class m{constructor(){this.httpClient=c(R)}postLogin(e){return this.httpClient.post("https://freyja-gek5.onrender.com/api/v1/orders",e).pipe(b())}};m.\u0275fac=function(o){return new(o||m)},m.\u0275prov=P({token:m,factory:m.\u0275fac,providedIn:"root"});let i=m;return i})();var w=function(i){return i[i.\u661F\u671F\u65E5=0]="\u661F\u671F\u65E5",i[i.\u661F\u671F\u4E00=1]="\u661F\u671F\u4E00",i[i.\u661F\u671F\u4E8C=2]="\u661F\u671F\u4E8C",i[i.\u661F\u671F\u4E09=3]="\u661F\u671F\u4E09",i[i.\u661F\u671F\u56DB=4]="\u661F\u671F\u56DB",i[i.\u661F\u671F\u4E94=5]="\u661F\u671F\u4E94",i[i.\u661F\u671F\u516D=6]="\u661F\u671F\u516D",i}(w||{});function ae(i,m){if(i&1&&(t(0,"div",39),p(1,"span",47),t(2,"p"),r(3),n()()),i&2){let l=d().$implicit;a(3),f(l.title)}}function le(i,m){if(i&1&&F(0,ae,4,1,"div",46),i&2){let l=m.$implicit;y(0,l.isProvide?0:-1)}}function me(i,m){if(i&1&&(t(0,"div",49),p(1,"span",47),t(2,"p"),r(3),n()()),i&2){let l=d().$implicit;a(3),f(l.title)}}function pe(i,m){if(i&1&&F(0,me,4,1,"div",48),i&2){let l=m.$implicit;y(0,l.isProvide?0:-1)}}function ue(i,m){if(i&1&&(t(0,"div",49),p(1,"span",47),t(2,"p"),r(3),n()()),i&2){let l=d().$implicit;a(3),f(l.title)}}function ce(i,m){if(i&1&&F(0,ue,4,1,"div",48),i&2){let l=m.$implicit;y(0,l.isProvide?0:-1)}}function de(i,m){if(i&1){let l=$();t(0,"div")(1,"div",1)(2,"div",2)(3,"div",3),p(4,"span",4),t(5,"h3"),r(6,"\u78BA\u8A8D\u8A02\u623F\u8CC7\u8A0A"),n()(),t(7,"div",5)(8,"div",6)(9,"div",7)(10,"h3",8),r(11,"\u8A02\u623F\u8CC7\u8A0A"),n(),t(12,"div",7)(13,"div",9)(14,"div")(15,"div",10),p(16,"div",11),t(17,"p",12),r(18,"\u9078\u64C7\u623F\u578B"),n()(),t(19,"p"),r(20),n()(),t(21,"app-button",13),g("clickEvent",function(){h(l);let o=d();return x(o.routerPage("/rooms"))}),r(22,"\u7DE8\u8F2F"),n()(),t(23,"div",9)(24,"div")(25,"div",10),p(26,"div",11),t(27,"p",12),r(28,"\u8A02\u623F\u65E5\u671F"),n()(),t(29,"p",14),r(30),n(),t(31,"p"),r(32),n()(),t(33,"app-button",13),g("clickEvent",function(){h(l);let o=d();return x(o.routerPage("/rooms",o.roomId))}),r(34,"\u7DE8\u8F2F"),n()(),t(35,"div",9)(36,"div")(37,"div",10),p(38,"div",11),t(39,"p",12),r(40,"\u623F\u5BA2\u4EBA\u6578"),n()(),t(41,"p"),r(42),n()(),t(43,"app-button",13),g("clickEvent",function(){h(l);let o=d();return x(o.routerPage("/rooms",o.roomId))}),r(44,"\u7DE8\u8F2F"),n()()()(),p(45,"app-divider",15),t(46,"div",16)(47,"div",17)(48,"h4"),r(49,"\u8A02\u623F\u4EBA\u8CC7\u8A0A"),n(),t(50,"app-button",18),g("clickEvent",function(){h(l);let o=d();return x(o.applyUserInfo())}),r(51,"\u5957\u7528\u6703\u54E1\u8CC7\u6599"),n()(),t(52,"div",7),p(53,"app-input",19)(54,"app-input",20)(55,"app-input",21),n(),t(56,"div",16)(57,"p",22),r(58,"\u5730\u5740"),n(),t(59,"div",23),p(60,"app-select",24)(61,"app-select",25),n(),p(62,"app-input",26),n()(),p(63,"app-divider",15),t(64,"h4",8),r(65,"\u623F\u9593\u8CC7\u8A0A"),n(),t(66,"div",7)(67,"div",7)(68,"div",27),p(69,"div",11),t(70,"h5"),r(71,"\u623F\u578B\u57FA\u672C\u8CC7\u8A0A"),n()(),t(72,"div",28)(73,"div",29),p(74,"span",30),t(75,"p",12),r(76),n()(),t(77,"div",29),p(78,"span",31),t(79,"p",12),r(80),n()(),t(81,"div",29),p(82,"span",32),t(83,"p",12),r(84),n()()()(),t(85,"div",7)(86,"div",27),p(87,"div",11),t(88,"h5"),r(89,"\u623F\u9593\u683C\u5C40"),n()(),t(90,"div",33)(91,"div",34),E(92,le,1,1,null,null,S),n()()(),t(94,"div",7)(95,"div",27),p(96,"div",11),t(97,"h5"),r(98,"\u623F\u5167\u8A2D\u5099"),n()(),t(99,"div",33)(100,"div",35),E(101,pe,1,1,null,null,S),n()()(),t(103,"div",7)(104,"div",27),p(105,"div",11),t(106,"h5"),r(107,"\u5099\u54C1\u63D0\u4F9B"),n()(),t(108,"div",33)(109,"div",35),E(110,ce,1,1,null,null,S),n()()()()(),t(112,"div",36),p(113,"img",37),t(114,"div",7)(115,"h4"),r(116,"\u50F9\u683C\u8A73\u60C5"),n(),t(117,"div")(118,"div",38)(119,"div",39)(120,"p"),r(121),_(122,"number"),n(),t(123,"div",40),p(124,"span",41),t(125,"p"),r(126),n()()(),t(127,"p"),r(128),_(129,"number"),n()(),t(130,"div",42)(131,"p"),r(132,"\u4F4F\u5BBF\u6298\u6263"),n(),t(133,"p",43),r(134,"-NT$ 1,000"),n()(),p(135,"app-divider",44),t(136,"div",42)(137,"p",12),r(138,"\u7E3D\u50F9"),n(),t(139,"p",12),r(140),_(141,"number"),n()()()(),t(142,"app-button",45),g("clickEvent",function(){h(l);let o=d();return x(o.Order())}),r(143,"\u78BA\u8A8D\u8A02\u623F"),n()()()()()()}if(i&2){let l=m.ngIf,e=d();a(20),f(l.name),a(1),u("buttonType","text"),a(9),s("\u5165\u4F4F\uFF1A",e.checkInFormatDate,""),a(2),s("\u9000\u623F\uFF1A",e.checkOutFormatDate,""),a(1),u("buttonType","text"),a(9),s("",e.queryParam.peopleNum," \u4EBA"),a(1),u("buttonType","text"),a(3),u("formGroup",e.formGroup),a(4),u("buttonType","text"),a(3),u("formGroup",e.formGroup)("name","name")("title","\u59D3\u540D")("placeholder","\u8ACB\u8F38\u5165\u59D3\u540D"),a(1),u("formGroup",e.formGroup)("name","phone")("title","\u624B\u6A5F\u865F\u78BC")("placeholder","\u8ACB\u8F38\u5165\u624B\u6A5F\u865F\u78BC"),a(1),u("formGroup",e.formGroup)("name","email")("title","\u96FB\u5B50\u4FE1\u7BB1")("placeholder","\u8ACB\u8F38\u5165\u96FB\u5B50\u4FE1\u7BB1"),a(1),u("formGroup",e.formGroup.controls.address),a(4),u("options",e.cityList)("formGroup",e.formGroup.controls.address)("name","city"),a(1),u("options",e.regionList)("formGroup",e.formGroup.controls.address)("name","zipcode"),a(1),u("formGroup",e.formGroup.controls.address)("name","detail")("placeholder","\u8ACB\u8F38\u5165\u8A73\u7D30\u5730\u5740"),a(14),f(l.areaInfo),a(4),f(l.bedInfo),a(4),s("2-",l.maxPeople," \u4EBA"),a(8),I(l.layoutInfo),a(9),I(l.facilityInfo),a(9),I(l.amenityInfo),a(3),u("src",l.imageUrl,N),a(8),s("NT$ ",k(122,40,l.price,"1.0-0"),""),a(5),s("",e.totalDate()," \u665A"),a(2),s("NT$ ",k(129,43,l.price*(e.totalDate()||1),"1.0-0"),""),a(12),s("NT$ ",k(141,46,l.price*(e.totalDate()||1)-1e3,"1.0-0"),""),a(2),u("disabled",e.formGroup.invalid)}}var ze=(()=>{let m=class m{constructor(){this.roomId="",this.checkInFormatDate="",this.checkOutFormatDate="",this.orderService=c(re),this.loginService=c(H),this.roomsService=c(J),this.route=c(j),this.router=c(M),this.datePickerSerivce=c(K),this.fb=c(Z),this.totalDate=this.datePickerSerivce.dateDifferent,this.roomDetail$=this.route.paramMap.pipe(G(e=>(this.roomId=e.get("id")??"",e.get("id"))),B(e=>this.roomsService.getRoom(e??"")),G(e=>e),b())}ngOnInit(){this.loginService.getUser()?.subscribe(),this.route.queryParamMap.subscribe(e=>{this.queryParam={peopleNum:+e.get("peopleNum"),checkInDate:e.get("checkInDate"),checkOutDate:e.get("checkOutDate")};let o=new Date(this.queryParam.checkInDate);this.checkInFormatDate=`${o.getMonth()+1} \u6708 ${o.getDate()}${w[new Date(this.queryParam.checkInDate).getDay()]}`;let v=new Date(this.queryParam.checkOutDate);this.checkOutFormatDate=`${v.getMonth()+1} \u6708 ${v.getDate()}${w[new Date(this.queryParam.checkOutDate).getDay()]}`}),this.initFormGroup(),this.setCityList(),this.setRegionList(this.formGroup.controls.address.controls.city.value),this.formGroup.controls.address.controls.city.valueChanges.subscribe(e=>{this.setRegionList(e),this.formGroup.controls.address.controls.zipcode.setValue(this.formGroup.controls.address.controls.zipcode.value)})}initFormGroup(){this.formGroup=this.fb.group({name:this.fb.control("",{nonNullable:!0,validators:C("\u8ACB\u8F38\u5165\u59D3\u540D")}),phone:this.fb.control("",{nonNullable:!0,validators:C("\u8ACB\u8F38\u5165\u624B\u6A5F\u865F\u78BC")}),email:this.fb.control("",{nonNullable:!0,validators:C("\u8ACB\u8F38\u5165\u96FB\u5B50\u4FE1\u7BB1")}),address:this.fb.group({city:this.fb.control("100",{nonNullable:!0}),zipcode:this.fb.control("104",{nonNullable:!0}),detail:this.fb.control("",{nonNullable:!0,validators:C("\u8ACB\u8F38\u5165\u8A73\u7D30\u5730\u5740")})})})}setCityList(){this.cityList=D.map(e=>({label:e.name,value:e.code.toString()}))}setRegionList(e){this.regionList=D.find(o=>o.code.toString()===e).region.map(o=>({label:o.name,value:o.code.toString()}))}cityCodeMapping(e){return D.find(o=>o.name===e).code.toString()}applyUserInfo(){let e=this.loginService.userInfo();this.formGroup.patchValue({name:e.name,phone:e.phone,email:e.email,address:{city:this.cityCodeMapping(e.address.city),zipcode:e.address.zipcode.toString(),detail:e.address.detail}})}Order(){let e={roomId:this.roomId,checkInDate:this.datePickerSerivce.startDate(),checkOutDate:this.datePickerSerivce.endDate(),peopleNum:this.queryParam.peopleNum,userInfo:{name:this.formGroup.controls.name.value,email:this.formGroup.controls.email.value,phone:this.formGroup.controls.phone.value,address:{city:this.formGroup.controls.address.controls.city.value,zipcode:+this.formGroup.controls.address.controls.zipcode.value,detail:this.formGroup.controls.address.controls.detail.value,county:this.formGroup.controls.address.controls.city.value}}};this.orderService.postLogin(e).subscribe({next:o=>{if(o.status){let v={queryParams:A({},o.result)};this.router.navigate(["/success",v])}}})}routerPage(e,o){o?this.router.navigate([e,o]):this.router.navigate([e])}};m.\u0275fac=function(o){return new(o||m)},m.\u0275cmp=T({type:m,selectors:[["app-confirm-page"]],standalone:!0,features:[V],decls:2,vars:3,consts:[[4,"ngIf"],[1,"py-[12.5rem]","bg-primary-tint"],[1,"container"],[1,"flex","items-center","gap-2","mb-10"],[1,"icon-ic_left"],[1,"flex","justify-between","gap-6","relative"],[1,"w-[46.625rem]"],[1,"flex","flex-col","gap-6"],[1,"mb-10"],[1,"flex","justify-between","items-center","gap-4"],[1,"flex","gap-3","items-center","mb-2"],[1,"w-1","h-6","relative","bg-primary-base","rounded-[0.75rem]"],[1,"text-title"],[1,"text-black",3,"buttonType","clickEvent"],[1,"mb-2"],[1,"my-[2.9375rem]"],[3,"formGroup"],[1,"flex","justify-between","items-center","mb-10"],[1,"text-primary-base",3,"buttonType","clickEvent"],["formControlName","name",1,"text-black",3,"formGroup","name","title","placeholder"],["formControlName","phone",1,"text-black",3,"formGroup","name","title","placeholder"],["formControlName","email",1,"text-black",3,"formGroup","name","title","placeholder"],[1,"text-white","font-bold","mb-2"],[1,"flex","gap-2","mb-4"],["formControlName","city",1,"w-1/2",3,"options","formGroup","name"],["formControlName","zipcode",1,"w-1/2",3,"options","formGroup","name"],["formControlName","detail",1,"text-white",3,"formGroup","name","placeholder"],[1,"flex","gap-3","items-center"],[1,"flex","items-center","gap-4"],[1,"w-[6.0625rem]","flex","flex-col","gap-2","px-4","py-[1.28125rem]","bg-white","rounded-lg"],[1,"icon-ic_size","text-primary-base"],[1,"icon-ic_bed","text-primary-base"],[1,"icon-ic_person","text-primary-base"],[1,"w-full","p-6","bg-white","rounded-lg"],[1,"w-[34.375rem]","flex","flex-wrap","items-center","gap-10"],[1,"w-[40.625rem]","flex","flex-wrap","gap-y-2","items-center","gap-10"],[1,"sticky","flex","flex-col","gap-10","top-[2.5rem]","w-[29.875rem]","h-[42.375rem]","bg-white","rounded-[1.25rem]","p-10","shadow-md"],["alt","",1,"h-[17rem]","rounded-lg",3,"src"],[1,"flex","justify-between","items-center","mb-3"],[1,"flex","items-center","gap-2"],[1,"flex","items-center","gap-1"],[1,"icon-ic_close","icon-size-sm"],[1,"flex","justify-between","items-center"],[1,"text-primary-base"],[1,"my-6"],[3,"disabled","clickEvent"],["class","flex items-center gap-2"],[1,"icon-ic_check","text-primary-base"],["class","flex items-center gap-2 min-w-[6.125rem]"],[1,"flex","items-center","gap-2","min-w-[6.125rem]"]],template:function(o,v){o&1&&(F(0,de,144,49,"div",0),_(1,"async")),o&2&&u("ngIf",z(1,1,v.roomDetail$))},dependencies:[U,te,ie,ne,O,L,q,ee,Q,W,X,Y]});let i=m;return i})();export{ze as default};
