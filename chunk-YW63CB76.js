import{a as g}from"./chunk-PC5BKWSZ.js";import{H as n,L as h,P as c,V as p,k as a,ua as r,va as m,x as u}from"./chunk-7VSCR5LV.js";import{a as i}from"./chunk-2XJVAMHT.js";var v=(()=>{let t=class t{constructor(){this.user=m(null),this.userInfo=r(()=>this.user()),this.isLoggedIn=r(()=>this.user()!==null),this.isLoggedOut=r(()=>this.user()===null),this.httpClient=p(g)}postLogin(s,e){return this.httpClient.post("https://freyja-gek5.onrender.com/api/v1/user/login",s).pipe(h(l=>{this.user.update(f=>i(i({},f),l.result)),e?localStorage.setItem("record",JSON.stringify({isRecord:e,email:s.email})):localStorage.removeItem("record"),localStorage.setItem("token",l.token)}),n())}getUser(){return localStorage.getItem("token")?this.httpClient.get("https://freyja-gek5.onrender.com/api/v1/user").pipe(u(()=>this.catchAuthError()),n()):null}logout(){localStorage.removeItem("token"),this.user.set(null)}catchAuthError(){return a(()=>this.logout())}};t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();export{v as a};
