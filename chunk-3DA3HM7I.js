import{a as g}from"./chunk-QCWOQPV6.js";import{H as i,L as l,P as h,V as p,k as u,ta as n,ua as m,x as c}from"./chunk-RQ5LHFRB.js";import{a as o}from"./chunk-2XJVAMHT.js";var v=(()=>{let t=class t{constructor(){this.user=m(null),this.isLoggedIn=n(()=>this.user()!==null),this.isLoggedOut=n(()=>this.user()===null),this.httpClient=p(g)}postLogin(r,e){return this.httpClient.post("https://freyja-gek5.onrender.com/api/v1/user/login",r).pipe(l(a=>{this.user.update(f=>o(o({},f),a.result)),e?localStorage.setItem("record",JSON.stringify({isRecord:e,email:r.email})):localStorage.removeItem("record"),localStorage.setItem("token",a.token)}),i())}getUser(){return localStorage.getItem("token")?this.httpClient.get("https://freyja-gek5.onrender.com/api/v1/user").pipe(l(r=>{this.user.update(e=>o(o({},e),r.result)),console.log(this.user())}),c(()=>this.catchAuthError()),i()):null}logout(){localStorage.removeItem("token"),this.user.set(null)}catchAuthError(){return u(()=>this.logout())}};t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=h({token:t,factory:t.\u0275fac,providedIn:"root"});let s=t;return s})();export{v as a};
